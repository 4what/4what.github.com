"undefined" == typeof Cmn && (Cmn = {}), "undefined" == typeof Cmn.Func && (Cmn.Func = {}), function () { var a, b, c, d; Cmn.Func.BaiduMapKey = "9KAiuPrKKoy1soPCrBrmskPg", Cmn.Func.GetAddrByLbs = function (a, b) { function c(c) { var d = b; (void 0 == d || "" == d) && (d = Cmn.Func.BaiduMapKey), $.ajax({ type: "Post", url: "http://api.map.baidu.com/geocoder/v2/?ak=" + d + "&location=" + c.coords.latitude + "," + c.coords.longitude + "&output=json&pois=0", contentType: "application/x-www-form-urlencoded", dataType: "jsonp", jsonp: "callback", success: function (b) { return 0 == b.status ? a(b.result.addressComponent) : a(null), !0 }, error: function () { return a(null), !1 } }) } navigator.geolocation ? navigator.geolocation.getCurrentPosition(c, function () { a(null) }) : a(null) }, Cmn.Func.GetCurPosition = function (a) { navigator.geolocation ? navigator.geolocation.getCurrentPosition(a, function () { a(null) }) : a(null) }, Cmn.Func.IsHorizontalScreen = function () { return 0 == window.orientation || 180 == window.orientation ? !1 : 90 == window.orientation || -90 == window.orientation ? !0 : void 0 }, Cmn.Func.GetWindowsWidth = function () { return $("body").width() }, Cmn.Func.GetWindowsHeight = function () { return $("body").width() * $(window).height() / $(window).width() }, a = null, b = null, c = !1, Cmn.Func.MobileAdaptiveMode = { Width: "Width", WidthHeight: "WidthHeight", WidthCutOutHeight: "WidthCutOutHeight" }, d = function (a) { var b, c, d; if (void 0 != a && "" != a && Cmn.Func.IsString(a)) { if (Cmn.Func.IsHorizontalScreen()) return Cmn.DebugLog("是横屏" + Cmn.Func.GetWindowsHeight() + " window.height:" + $(window).height() + "window.width:" + $(window).width()), b = window.screen.width / window.screen.height, b > 1 && (b = 1 / b), c = $(window).width(), Cmn.Func.IsIOS() && c < Cmn.Func.GetWindowsWidth() && (c = Cmn.Func.GetWindowsWidth()), d = c * b, $("body .AdviseVerticalImg").length <= 0 ? $("body").append("<div class='AdviseVerticalImg' style='position:fixed;left:0px;top:0px;z-index:10001;background:rgba(00, 00, 00, 1) none repeat scroll 0 0 !important;filter:Alpha(opacity=100);background:#000000;width:" + c + "px;height:100%;text-align:center;'> " + "<img height='100%' width='100%' src='" + a + "' /></div>") : ($(".AdviseVerticalImg").width(c), $(".AdviseVerticalImg img").height(.8 * d), $(".AdviseVerticalImg").fadeIn(100)), $(".AdviseVerticalImg").off("touchstart").on("touchstart", function (a) { a.preventDefault(), Cmn.DebugLog("触摸横屏提示层") }), !0; $(".AdviseVerticalImg").hide(), $(".AdviseVerticalImg").off("touchstart") } return !1 }, Cmn.Func.MobileAdaptive = function (e, f, g, h, i) { var j, k, l, m, n; Cmn.DebugLog(navigator.userAgent + "  自适应方案：" + h), void 0 == h && (h = Cmn.Func.MobileAdaptiveMode.Width), d(g) || (h == Cmn.Func.MobileAdaptiveMode.Width || h == Cmn.Func.MobileAdaptiveMode.WidthCutOutHeight ? ($("body").width(e), Cmn.Func.IsIOS() ? (Cmn.DebugLog("是IOS系统"), $("[name='viewport']").attr("content", "width=" + e + ",user-scalable=no;")) : null != navigator.userAgent.match(/Nexus/i) ? (Cmn.DebugLog("操作系统Nexus"), $("body").css("zoom", 100 * ($(window).width() / e) + "%")) : null != navigator.userAgent.match(/android\s*[\d\.]+/i) ? (Cmn.DebugLog("是安卓系统"), j = navigator.userAgent.match(/android\s*[\d\.]+/i)[0].replace(/android\s*/i, ""), j.indexOf(".") > 0 && (j = j.match(/[\d]+\.[\d]+/i)), j >= 4.4 ? (Cmn.DebugLog("安卓版本大于等于4.4:" + j), $("body").css("zoom", 100 * ($(window).width() / e) + "%")) : (Cmn.DebugLog("安卓版本小于4.4:.." + j), Cmn.DebugLog("安卓版本 4.2.2,window.screen.width:" + window.screen.width + " window.devicePixelRatio:" + window.devicePixelRatio), k = 160 * e / window.screen.width * window.devicePixelRatio, $("[name='viewport']").attr("content", "width=" + e + ", user-scalable=no, target-densitydpi=" + k.toFixed(0) + ";"))) : (Cmn.DebugLog("是其他操作系统"), a = $(window).width(), b = $(window).height(), Cmn.DebugLog("window.Width:" + a + "window.Height:" + b), l = a / e, $("[name='viewport']").attr("content", "width=device-width,initial-scale=" + l + ",maximum-scale=" + l + ",minimum-scale=" + l + ",user-scalable=no;")), h == Cmn.Func.MobileAdaptiveMode.WidthCutOutHeight && (Cmn.DebugLog("是WidthCutOutHeight  GetWindowsHeight:" + Cmn.Func.GetWindowsHeight() + " mainContentHeight：" + f + " bodyHeight:" + $("body").height()), Cmn.Func.GetWindowsHeight() > f ? (Cmn.DebugLog("满足条件，需要隐藏滚动条"), $("body").height() > Cmn.Func.GetWindowsHeight() && ($("body").height(Cmn.Func.GetWindowsHeight()), $("body").css("overflow-y", "hidden"))) : $("body").css("overflow-y", "scroll"))) : h == Cmn.Func.MobileAdaptiveMode.WidthHeight && (Cmn.Func.IsIOS() ? (m = e, e * $(window).height() / $(window).width() < f && (m = f / ($(window).height() / $(window).width())), $("[name='viewport']").attr("content", "width=" + m + ",user-scalable=no;"), $("body").width(m), Cmn.DebugLog("windowWidth11:" + $(window).width() + " windowHeight:" + $(window).height())) : null != navigator.userAgent.match(/Android\s*4.4/i) ? (Cmn.DebugLog("Android 4.4"), $("body").css("zoom", 100 * ($(window).width() / e) + "%")) : (a = $(window).width(), b = $(window).height(), l = a / e, l > b / f && (l = b / f), $("body").width(a / l), Cmn.DebugLog("window.Width:" + a + "window.Height:" + b + " _multiple：" + l), k = 160 * a / l / window.screen.width * window.devicePixelRatio, $("[name='viewport']").attr("content", "width=" + a / l + ", user-scalable=no, target-densitydpi=" + k.toFixed(0) + ";")))), n = function () { function c() { setTimeout(function () { Cmn.Func.IsHorizontalScreen() && $(window).width() >= $(window).height() || 0 == Cmn.Func.IsHorizontalScreen() && $(window).width() <= $(window).height() ? (Cmn.Func.MobileAdaptive(e, f, g, h), void 0 != i && i()) : c() }, 50) } $(".AdviseVerticalImg").hide(); var b = $(window).width(); $("[name='viewport']").attr("content", "width=device-width,user-scalable=no;"), Cmn.DebugLog("旋转" + window.orientation + "  _widthBeforChange:" + b + "  window.width:" + $(window).width()), c() }, 0 == c && ($(window).on("orientationchange", n), c = !0, $("[name='viewport']").length < 1 && alert("页面上必须要加上默认的viewport。(<meta content='width=device-width,user-scalable=no;' name='viewport' />)")), Cmn.DebugLog("自适应后viewport:" + $("[name='viewport']").attr("content")) }, Cmn.Func.SaveImgToLocal = function (a) { var b, c; if (a = Cmn.Func.GetAbsoluteUrl(a), Cmn.Func.IsWeiXin()) b = new Array, b[0] = a, WeixinJSBridge.invoke("imagePreview", { current: $(this).attr("src"), urls: b }); else { for (c = window.open(a, "", "width=1, height=1, top=5000, left=5000") ; "complete" != c.document.readyState && "complete" != c.document.readyState;); c.document.execCommand("SaveAs"), c.close() } }, Cmn.Func.Shake = function (a, b) { function k(a) { var k, l, m, n; 0 != IsShake && (k = a.accelerationIncludingGravity, l = (new Date).getTime(), l - d > 100 && (m = l - d, d = l, e = k.x, f = k.y, g = k.z, n = 1e4 * (Math.abs(e + f + g - h - i - j) / m), n > c && b && IsShake && (IsShake = !1, b()), h = e, i = f, j = g)) } var c, d, e, f, g, h, i, j; return 1 == arguments.length && (a = 800, "function" == typeof arguments[0] && (b = arguments[0]), "boolean" == typeof arguments[0]) ? (window.IsShake = !0, "undefined") : (c = a || 800, d = 0, window.IsShake = !0, window.addEventListener("devicemotion", k, !1), void 0) }, Cmn.Func.TouchSlide = function (a, b, c, d, e) { var g, h, i, f = $(a); return f.length < 1 ? !1 : (g = null, h = null, i = "", f.off("touchstart").on("touchstart", function (a) { a = event.touches ? event.touches[0] : a, null == g && null == h && (g = a.pageX), h = a.pageY }), f.off("touchmove").on("touchmove", function (a) { var d, f, j; return null == g && null == h ? (d.preventDefault(), void 0) : (d = event.touches ? event.touches[0] : a, f = Math.abs(d.pageX - g), j = Math.abs(d.pageY - h), f > j ? (d.pageX - g > 0 ? Math.abs(d.pageX - g) > b && (i = "right", c && c(i, f), e && "1" != e || (g = null, h = null)) : d.pageX - g < 0 && Math.abs(d.pageX - g) > b && (i = "left", c && c(i, f), e && "1" != e || (g = null, h = null)), a.preventDefault()) : j > f && (d.pageY - h > 0 ? Math.abs(d.pageY - h) > b && (i = "down", c && c(i, f), e && "1" != e || (g = null, h = null)) : d.pageY - h < 0 && Math.abs(d.pageY - h) > b && (i = "up", c && c(i, f), e && "1" != e || (g = null, h = null)), a.preventDefault()), void 0) }), f.off("touchend").on("touchend", function () { g = null, h = null, i && d && d(i), i = "" }), void 0) }, Cmn.Func.ImageLazyLoading = function (a, b, c) { function h(a, b) { var c = new Image; c.onload = function () { i(b, a, !1) }, c.onerror = function () { i(b, a, !0) }, c.src = a, c.complete && i(b, a, !1) } function i(a, e, h) { d++; var i = Math.ceil(100 * (d / f)); i = d == f ? 100 : i >= 100 ? 100 : i, h ? (g.push(e), $(a).removeAttr("lazypath")) : $(a).removeAttr("lazypath").attr("src", e), b && b(i, e), c && d == f && c(g) } var d, e, f, g; a && (a = "body"), d = 0, e = $(a).find("img[lazypath]") || $(a).find("img"), f = e.length, e.each(function (a, b) { if (void 0 !== $(b).attr("lazypath")) { var c = $(b).attr("lazypath"); c && h(c, b) } else d++ }), g = [] }, Cmn.Func.Html5FileUpload = function () { var a = function () { }; return function () { return new a } }() }();